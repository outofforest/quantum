// Code generated by command: go run avo.go -out ../asm.s -stubs ../asm_stub.go -pkg compare. DO NOT EDIT.

#include "textflag.h"

// func Compare(v uint64, x *uint64, z *uint8) uint8
// Requires: AVX512DQ, AVX512F
TEXT Â·Compare(SB), NOSPLIT, $0-25
	MOVQ         x+8(FP), AX
	VMOVDQU64    (AX), Z0
	MOVQ         z+16(FP), AX
	MOVQ         v+0(FP), DX
	VPBROADCASTQ DX, Z1
	VPCMPEQQ     Z0, Z1, K1
	MOVD         $0x0000000000000000, DX
	KMOVB        K1, DX

loop:
	TESTQ DX, DX
	JZ    return
	BSFQ  DX, CX
	BTRQ  CX, DX
	MOVB  CL, (AX)
	ADDQ  $0x01, AX
	JMP   loop

return:
	MOVD         $0x0000000000000000, AX
	VPBROADCASTQ AX, Z1
	VPCMPEQQ     Z0, Z1, K1
	KMOVB        K1, DX
	TESTQ        DX, DX
	JZ           return2
	BSFQ         DX, CX
	MOVB         CL, ret+24(FP)

return2:
	RET
